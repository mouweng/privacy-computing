# 开题讲稿

各位老师同学们好，我叫翁一帆，我开题论文题目是《基于区块链的联邦学习框架设计与实现》

## 目录

这是本次要讲的目录

## 联邦学习介绍

首先我介绍一下什么是联邦学习。

联邦学习是利用分散在各个参与方的数据集，通过隐私保护技术融合多方数据信息，协同构建全局模型的一种**分布式**训练方式。

在模型训练过程中，模型的相关信息（如模型参数、模型结构、梯度等）能够在各参与方之间交换，但训练数据**不会离开本地**。

google想要利用全球用户的手机数据训练输入法智能预测模型，但是由于法律和隐私保护的问题，不能获取用户数据到中心服务器训练。

各家医院想要联合医疗数据训练智能诊断模型，但又不允许把数据泄露出去。

这个时候，联邦学习就发挥作用。

## 联邦学习与分布式机器学习

联邦学习本质上是一种分布式机器学习，但是与分布式机器学习又存在如下区别：

- 首先，用户对自己的设备由绝对的控制权，用户可以随时让自己的设备停止参与计算和通信。
- 参与联邦学习的节点大多是手机、ipad等不稳定的设备，且计算性能差异性非常大
- 由于节点的特点，联邦学习主要的瓶颈在于通信，通信代价远大于计算代价。
- 联邦学习的数据并非独立同分布
- 节点数量的数量级也是完全不一样的。

总结：虽然联邦学习是一种分布式机器学习，但是联邦学习有很多独特的问题和难点，导致建模和计算都很麻烦。

## 联邦学习存在的问题

既然我们要设计框架，就要解决联邦学习中存在的难点。

根据联邦学习的特性，目前对联邦学习的研究中，主要存在隐私泄露、通信开销大、鲁棒性不足这三大问题。我们框架的设计也是需要考虑这三大问题的。

## 隐私泄露

那么我们会问，联邦学习不就是为了保护隐私而生么，为什么又会存在隐私泄露呢？

其实不然，在联邦学习中会进行模型和梯度的交换，模型和梯度其实是保留了一部分数据信息的，可以通过这些信息进行反推。例如图像训练中，用户的肖像数据，根据梯度信息虽然不能推断出图片的具体肖像，但是能获取他是男是女，是白人还是黑人等信息。

这几篇文章就是在论述通过模型是能够反推出数据信息的。

目前解决隐私泄露问题，主流的方法有差分隐私、和密码学上的同态加密。

- 差分隐私本质上就是通过给数据加噪声但对模型的收敛和效果影响很小的一种方式，即使用户获取了输出结果，也无法通过结果推测输入数据来自哪一方。
- 同态加密：在密文上计算的结果（例如加减乘除四则运算）在被解密后与在明文上的计算结果相一致的，就如同对明文执行了一样的操作计算。

## 通信开销

设备运行的不稳定、客户端服务器需要不断交换大量模型参数、节点有限的带宽，导致了通信开销和通信效率是联邦学习的关键瓶颈之一。

主要解决方向有增加计算并行度、增加参与方计算量、减少通信等方式。

## 联邦平均

谷歌的论文中提出联邦平均算法，本质是通过增加客户端节点计算量来减少通信次数。在worker节点进行很多次epoch，再将模型信息发送给服务端进行聚合，从而提高通信效率。

天下没有免费的午餐，FedAvg减少了通信量，但是增加了Worker节点的计算量，牺牲计算量为代价，换取通信量。因为联邦学习中计算代价小，通信代价大，所以这种算法是合理的。

## 模型压缩

另外类思路是模型压缩。比如有量化、稀疏化、知识蒸馏等模型压缩方法。

主要是减少模型参数和大小，但尽量少的影响模型的效果。

- 量化方法：降低更新参数的“分辨率”，如：整数化，二值化
- 稀疏化：稀疏模型将大量的冗余变量去除，只保留与响应变量最相关的内容。
- 知识蒸馏：做法是先训练一个teacher网络，然后使用这个teacher网络的去训练student网络。可以用来将网络从大网络转化成一个小网络，并保留接近于大网络的性能；

## 鲁棒性

第三点需要解决的是鲁棒性。

这几篇论文主要介绍联邦学习中的攻防策略，攻击节点通过修改训练数据或者模型，可以达到下毒的目的，总归来说就是攻击很容易，但是防御很复杂。

目前大多是通过模型的筛选等方式来进行防御，但由于联邦学习数据非独立同分布的原因，每个节点贡献的模型存在差异是合理的，这种方式也存在着一定的局限性。

## 联邦学习结合区块链

鲁棒性的解决非常困难。近几年区块链非常火热，我们可以利用区块链的不可篡改与数据存证的特性来对联邦学习的架构做一些改造，但大多数区块链和联邦学习相结合的方向都是区块链架构取代联邦学习中心节点，因为中心节点被攻击会导致整个架构瘫痪，虽然这能保证中心节点不受攻击，但是实现难度大且由于区块链的特性导致整个系统效率低下。

而我的思路是利用联邦学习的不可篡改性来对训练数据进行存证和模型的存证，确保模型训练过程中数据和模型不会被下毒，这个验证的过程是可以异步来进行的，同时通过智能合约来激励节点贡献数据和算力，实现模型收益合理公开透明分配。

## 主流框架

目前以FATE为代表的联邦学习框架可支持的内容已经相对完善，但是在一些层面还是可以进行拓展，比如可视化、结合区块链、模型压缩等等。

## 总体架构设计

这是我的课题的总体架构设计。

从上至下分为API接口层、模型通信层、隐私保护层、区块链层、训练数据层，另外还有日志模块和可视化模块。

API接口层主要负责框架对外接口调用。

模型通信层主要负责模型通信控制，主要包括Socket通信、模型压缩。

算法层采用联邦平均算法FedAvg。

隐私保护层主要包括前面介绍到的差分隐私和同态加密算法。

区块链层主要用于数据存证和智能合约激励，利用默克尔树来计算数据摘要。

可视化模块基于模型训练过程中由日志模块生成的日志信息来进行渲染。

## 创新点

我的架构的创新点主要在于利用区块链的不可篡改和智能合约的特性，保证联邦学习节点数据和模型的不可篡改性。

另外融合隐私保护算法、模型压缩、FedAvg算法、可视化模块、区块链模块为一体，实现一个保护隐私、高效通信、鲁棒性高的联邦学习框架。

## 区块链模块

具体的，在区块链模块。

数据上链：由于区块链的存储能力是有限的，对于客户端数据来说，客户定期创建默克尔树（树中每个叶子节点代表客户端上的每一条数据），并将默克尔树存储在预先部署在链上的智能合约里面。

基于智能合约的激励机制：为了鼓励客户端积极参与模型训练，框架设计基于智能合约的激励机制。根据客户端用于本地训练的数据集大小和模型贡献度来奖励客户端相应的代币，所奖励的代币记录在智能合约中，可用于后续模型带来收益的分红。

区块链部署：**每个组织都拥有区块链数据的完整副本，可以用于审计，同时确保整个系统的可用性。**

## 可视化模块

主要包括**节点状态统计监控、模型训练过程监控、模型效果度量部分。**

主要用作联邦学习节点实时监控以及模型效果度量。

## 知识点

差分隐私

同态加密

量化

稀疏化

知识蒸馏

区块链模块

可视化模块

